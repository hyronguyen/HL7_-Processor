<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>HL7 to JSON</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    textarea, pre { width: 100%; height: 200px; }
    button { margin-top: 10px; padding: 10px 20px; }
  </style>
</head>
<body>

  <h2>HL7 OML ‚Üí JSON Escaped</h2>

  <label for="hl7Input">Nh·∫≠p b·∫£n tin HL7 OML trong "":</label><br>
  <textarea id="hl7Input" placeholder="D√°n b·∫£n tin HL7 OML v√†o ƒë√¢y..."></textarea><br>

  <button onclick="convertToJSON()">Chuy·ªÉn ƒë·ªïi sang JSON</button>
  <button onclick="copyJSON()">üìã Sao ch√©p JSON</button>

  <h3>JSON Output:</h3>
  <pre id="jsonOutput"></pre>

  <script>
    function escapeHL7String(str) {
      return str
        .replace(/\\/g, '\\\\')     // Escape backslashes
        .replace(/"/g, '\\"')       // Escape double quotes
        .replace(/\r/g, '\\r');     // Keep carriage return readable
    }

    function convertToJSON() {
      const hl7Text = document.getElementById('hl7Input').value.trim();
      if (!hl7Text) {
        alert('Vui l√≤ng d√°n d·ªØ li·ªáu HL7 tr∆∞·ªõc.');
        return;
      }

      const escaped = escapeHL7String(hl7Text);
      const jsonData = {
        data: escaped
      };

      const output = JSON.stringify(jsonData, null, 2);
      document.getElementById('jsonOutput').textContent = output;
    }

    function copyJSON() {
      const output = document.getElementById('jsonOutput').textContent;
      if (!output) {
        alert("Kh√¥ng c√≥ n·ªôi dung ƒë·ªÉ sao ch√©p.");
        return;
      }

      navigator.clipboard.writeText(output).then(() => {
        alert("‚úÖ ƒê√£ sao ch√©p JSON v√†o clipboard!");
      }).catch(err => {
        alert("‚ùå Kh√¥ng th·ªÉ sao ch√©p: " + err);
      });
    }
  </script>

</body>
</html>
